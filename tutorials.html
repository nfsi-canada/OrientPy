

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Tutorials &mdash;  0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Scripts" href="scripts.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> 
          

          
            
            <img src="_static/OrientPy_logo_small.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Quick Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="links.html">GitHub Repositories</a></li>
<li class="toctree-l1"><a class="reference internal" href="links.html#references">References</a></li>
</ul>
<p class="caption"><span class="caption-text">Disclaimer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="disclaimer.html">Disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="disclaimer.html#dlopy-licence">DLOPy Licence</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="orientpy.html">Licence</a></li>
<li class="toctree-l1"><a class="reference internal" href="orientpy.html#installation">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#modules">Modules</a></li>
</ul>
<p class="caption"><span class="caption-text">Scripts &amp; Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Scripts</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creating-the-stdb-database">Creating the <code class="docutils literal notranslate"><span class="pre">StDb</span></code> Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bng-analysis">BNG analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#automated-analysis">1. Automated analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#averaging">2. Averaging</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dl-analysis">DL analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">1. Automated analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">2. Averaging</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html"></a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Tutorials</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/tutorials.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tutorials">
<h1>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this headline">¶</a></h1>
<div class="section" id="creating-the-stdb-database">
<h2>Creating the <code class="docutils literal notranslate"><span class="pre">StDb</span></code> Database<a class="headerlink" href="#creating-the-stdb-database" title="Permalink to this headline">¶</a></h2>
<p>All the scripts provided require a <code class="docutils literal notranslate"><span class="pre">StDb</span></code> database containing station
information and metadata. Let’s first create this database for station
LOBS3 and send the prompt to a logfile</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ query_fdsn_stdb.py -N YH -C ?H? -S LOBS3 YH_list &gt; logfile
</pre></div>
</div>
<p>To check the station info for M08A, use the program <code class="docutils literal notranslate"><span class="pre">ls_stdb.py</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ls_stdb.py YH_list.pkl
Listing Station Pickle: YH_list.pkl
YH.LOBS3
--------------------------------------------------------------------------
1) YH.LOBS3
     Station: YH LOBS3
      Alternate Networks: None
      Channel: HH ;  Location: --
      Lon, Lat, Elev: -38.79220,  179.14729,  -3.540
      StartTime: 2014-05-15 00:00:00
      EndTime:   2015-06-23 23:59:59
      Status:    open
      Polarity: 1
      Azimuth Correction: 0.000000
</pre></div>
</div>
</div>
<div class="section" id="bng-analysis">
<h2>BNG analysis<a class="headerlink" href="#bng-analysis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="automated-analysis">
<h3>1. Automated analysis<a class="headerlink" href="#automated-analysis" title="Permalink to this headline">¶</a></h3>
<p>We wish to use the entire deployment time of station LOBS3 to calculate the
station orientation using teleseismic P-wave data. Since the file <code class="docutils literal notranslate"><span class="pre">YH_list.pkl</span></code>
contains only one station, it is not necessary to specify a
key. This option would be useful if the database contained several stations
and we were only interested in downloading data for LOBS3. In this case, we would
specify <code class="docutils literal notranslate"><span class="pre">--keys=LOBS3</span></code> or <code class="docutils literal notranslate"><span class="pre">--keys=YH.LOBS3</span></code>. We could use all the default
paramaters to do automated processing for regional events.
However, since we wish to analyze teleseismic data, we will edit a few of them to
include more waveform data around the predicted P-wave
arrival time. We also consider all earthquakes between 30 and 175 degrees, as the
program will automatically use either the P or PP waves to extract the waveforms.</p>
<p>The parameters to edit in this case are:
<code class="docutils literal notranslate"><span class="pre">--times=-5.,15.</span></code> to extract data from -5 to 15 seconds following P-wave arrival;
<code class="docutils literal notranslate"><span class="pre">--window=60.</span></code> to include 60 seconds of data;
<code class="docutils literal notranslate"><span class="pre">--minmax=6.</span></code> to limit the number of events to consider;
<code class="docutils literal notranslate"><span class="pre">--mindist=30.</span></code> for the minimum epicentral distance for teleseismic P; and
<code class="docutils literal notranslate"><span class="pre">--bp=0.04,0.1</span></code> to focus on the long-period P waves</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ bng_calc_auto --times=-5.,15. --window=60. --bp=0.04,0.1 --min-mag=6. --min-dist=30. YH_list.pkl
</pre></div>
</div>
<p>An example log printed on the terminal will look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|==============================================|</span>
<span class="o">|</span>                      <span class="n">LOBS3</span>                   <span class="o">|</span>
<span class="o">|==============================================|</span>
<span class="o">|</span>  <span class="n">Station</span><span class="p">:</span> <span class="n">YH</span><span class="o">.</span><span class="n">LOBS3</span>                           <span class="o">|</span>
<span class="o">|</span>      <span class="n">Channel</span><span class="p">:</span> <span class="n">HH</span><span class="p">;</span> <span class="n">Locations</span><span class="p">:</span> <span class="o">--</span>              <span class="o">|</span>
<span class="o">|</span>      <span class="n">Lon</span><span class="p">:</span>  <span class="mf">179.15</span><span class="p">;</span> <span class="n">Lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">38.79</span>               <span class="o">|</span>
<span class="o">|</span>      <span class="n">Start</span> <span class="n">time</span><span class="p">:</span> <span class="mi">2014</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>         <span class="o">|</span>
<span class="o">|</span>      <span class="n">End</span> <span class="n">time</span><span class="p">:</span>   <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">23</span> <span class="mi">23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mi">59</span>         <span class="o">|</span>
<span class="o">|</span> <span class="n">Output</span> <span class="n">Directory</span><span class="p">:</span>  <span class="n">BNG_RESULTS</span>
<span class="o">|</span> <span class="n">Save</span> <span class="n">Progress</span><span class="p">:</span>  <span class="kc">True</span>
<span class="o">|----------------------------------------------|</span>
<span class="o">|</span> <span class="n">Searching</span> <span class="n">Possible</span> <span class="n">events</span><span class="p">:</span>                   <span class="o">|</span>
<span class="o">|</span>   <span class="n">Start</span><span class="p">:</span> <span class="mi">2014</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                 <span class="o">|</span>
<span class="o">|</span>   <span class="n">End</span><span class="p">:</span>   <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">23</span> <span class="mi">23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mi">59</span>                 <span class="o">|</span>
<span class="o">|</span>   <span class="n">Mag</span><span class="p">:</span>   <span class="o">&gt;</span><span class="mf">6.0</span>                                <span class="o">|</span>
<span class="o">|</span>   <span class="n">Min</span> <span class="n">Distance</span><span class="p">:</span>  <span class="mf">30.0</span>
<span class="o">|</span>   <span class="n">Max</span> <span class="n">Distance</span><span class="p">:</span>  <span class="mf">175.0</span>
<span class="o">|</span>   <span class="n">Max</span> <span class="n">Depth</span><span class="p">:</span>     <span class="mf">1000.0</span>
<span class="o">|</span>   <span class="n">Request</span> <span class="n">Event</span> <span class="n">Catalogue</span><span class="o">...</span>                 <span class="o">|</span>
<span class="o">|</span> <span class="o">...</span>                                          <span class="o">|</span>
<span class="o">|</span>   <span class="n">Retrieved</span> <span class="mi">178</span> <span class="n">events</span>


<span class="o">**************************************************</span>
<span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">178</span><span class="p">):</span>  <span class="mi">20150623_121830</span> <span class="n">YH</span><span class="o">.</span><span class="n">LOBS3</span>
<span class="o">*</span>   <span class="n">Phase</span><span class="p">:</span> <span class="n">P</span>
<span class="o">*</span>   <span class="n">Origin</span> <span class="n">Time</span><span class="p">:</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">23</span> <span class="mi">12</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span><span class="mi">30</span>
<span class="o">*</span>   <span class="n">Lat</span><span class="p">:</span>  <span class="mf">27.69</span><span class="p">;</span>        <span class="n">Lon</span><span class="p">:</span>  <span class="mf">139.79</span>
<span class="o">*</span>   <span class="n">Dep</span><span class="p">:</span> <span class="mf">472.30</span> <span class="n">km</span><span class="p">;</span>     <span class="n">Mag</span><span class="p">:</span> <span class="mf">6.5</span>
<span class="o">*</span>   <span class="n">Dist</span><span class="p">:</span> <span class="mf">8420.96</span> <span class="n">km</span><span class="p">;</span>   <span class="n">Epi</span> <span class="n">dist</span><span class="p">:</span>  <span class="mf">75.73</span> <span class="n">deg</span>
<span class="o">*</span>   <span class="n">Baz</span><span class="p">:</span>  <span class="mf">324.49</span> <span class="n">deg</span><span class="p">;</span>   <span class="n">Az</span><span class="p">:</span> <span class="mf">149.23</span> <span class="n">deg</span>
<span class="o">*</span> <span class="n">Requesting</span> <span class="n">Waveforms</span><span class="p">:</span>
<span class="o">*</span>    <span class="n">Startime</span><span class="p">:</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">23</span> <span class="mi">12</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">26</span>
<span class="o">*</span>    <span class="n">Endtime</span><span class="p">:</span>  <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">23</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">26</span>
<span class="o">*</span>     <span class="n">LOBS3</span><span class="o">.</span><span class="n">HH</span> <span class="o">-</span> <span class="n">ZNE</span><span class="p">:</span>
<span class="o">*</span>          <span class="n">HH</span><span class="p">[</span><span class="n">ZNE</span><span class="p">]</span><span class="o">.--</span> <span class="o">-</span> <span class="n">Checking</span> <span class="n">Network</span>
<span class="o">*</span>          <span class="n">HH</span><span class="p">[</span><span class="n">Z12</span><span class="p">]</span><span class="o">.--</span> <span class="o">-</span> <span class="n">Checking</span> <span class="n">Network</span>
<span class="o">*</span> <span class="n">Stream</span> <span class="n">has</span> <span class="n">less</span> <span class="n">than</span> <span class="mi">3</span> <span class="n">components</span>
<span class="o">*</span> <span class="n">Error</span> <span class="n">retrieving</span> <span class="n">waveforms</span>
<span class="o">**************************************************</span>

<span class="o">**************************************************</span>
<span class="o">*</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">178</span><span class="p">):</span>  <span class="mi">20150620_021007</span> <span class="n">YH</span><span class="o">.</span><span class="n">LOBS3</span>
<span class="o">*</span>   <span class="n">Phase</span><span class="p">:</span> <span class="n">P</span>
<span class="o">*</span>   <span class="n">Origin</span> <span class="n">Time</span><span class="p">:</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span> <span class="mi">02</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">07</span>
<span class="o">*</span>   <span class="n">Lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">36.33</span><span class="p">;</span>        <span class="n">Lon</span><span class="p">:</span>  <span class="o">-</span><span class="mf">73.67</span>
<span class="o">*</span>   <span class="n">Dep</span><span class="p">:</span>  <span class="mf">17.40</span> <span class="n">km</span><span class="p">;</span>     <span class="n">Mag</span><span class="p">:</span> <span class="mf">6.4</span>
<span class="o">*</span>   <span class="n">Dist</span><span class="p">:</span> <span class="mf">8837.94</span> <span class="n">km</span><span class="p">;</span>   <span class="n">Epi</span> <span class="n">dist</span><span class="p">:</span>  <span class="mf">79.48</span> <span class="n">deg</span>
<span class="o">*</span>   <span class="n">Baz</span><span class="p">:</span>  <span class="mf">128.47</span> <span class="n">deg</span><span class="p">;</span>   <span class="n">Az</span><span class="p">:</span> <span class="mf">229.25</span> <span class="n">deg</span>
<span class="o">*</span> <span class="n">Requesting</span> <span class="n">Waveforms</span><span class="p">:</span>
<span class="o">*</span>    <span class="n">Startime</span><span class="p">:</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span> <span class="mi">02</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">13</span>
<span class="o">*</span>    <span class="n">Endtime</span><span class="p">:</span>  <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span> <span class="mi">02</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">13</span>
<span class="o">*</span>     <span class="n">LOBS3</span><span class="o">.</span><span class="n">HH</span> <span class="o">-</span> <span class="n">ZNE</span><span class="p">:</span>
<span class="o">*</span>          <span class="n">HH</span><span class="p">[</span><span class="n">ZNE</span><span class="p">]</span><span class="o">.--</span> <span class="o">-</span> <span class="n">Checking</span> <span class="n">Network</span>
<span class="o">*</span>          <span class="n">HH</span><span class="p">[</span><span class="n">Z12</span><span class="p">]</span><span class="o">.--</span> <span class="o">-</span> <span class="n">Checking</span> <span class="n">Network</span>
<span class="o">*</span>              <span class="o">-</span> <span class="n">Z12</span> <span class="n">Data</span> <span class="n">Downloaded</span>
<span class="o">*</span> <span class="n">Start</span> <span class="n">times</span> <span class="n">are</span> <span class="ow">not</span> <span class="nb">all</span> <span class="n">close</span> <span class="n">to</span> <span class="n">true</span> <span class="n">start</span><span class="p">:</span>
<span class="o">*</span>   <span class="n">HH1</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span><span class="n">T02</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mf">13.169200</span><span class="n">Z</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span><span class="n">T02</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mf">13.159182</span><span class="n">Z</span>
<span class="o">*</span>   <span class="n">HH2</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span><span class="n">T02</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mf">13.170000</span><span class="n">Z</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span><span class="n">T02</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mf">13.159982</span><span class="n">Z</span>
<span class="o">*</span>   <span class="n">HHZ</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span><span class="n">T02</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mf">13.171300</span><span class="n">Z</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span><span class="n">T02</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mf">13.161282</span><span class="n">Z</span>
<span class="o">*</span>   <span class="kc">True</span> <span class="n">start</span><span class="p">:</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span><span class="n">T02</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mf">13.169017</span><span class="n">Z</span>
<span class="o">*</span> <span class="o">-&gt;</span> <span class="n">Shifting</span> <span class="n">traces</span> <span class="n">to</span> <span class="n">true</span> <span class="n">start</span>
<span class="o">*</span> <span class="n">Sampling</span> <span class="n">rate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">an</span> <span class="n">integer</span> <span class="n">value</span><span class="p">:</span>  <span class="mf">100.00001525878906</span>
<span class="o">*</span> <span class="o">-&gt;</span> <span class="n">Resampling</span>
<span class="o">*</span> <span class="n">Waveforms</span> <span class="n">Retrieved</span><span class="o">...</span>
<span class="o">*</span> <span class="n">PHI</span><span class="p">:</span> <span class="mf">130.9734219019316</span>
<span class="o">*</span> <span class="n">SNR</span><span class="p">:</span> <span class="mf">15.56466980049146</span>
<span class="o">*</span> <span class="n">CC</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5339708571207897</span>
<span class="o">*</span> <span class="mi">1</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">R</span><span class="p">:</span> <span class="mf">0.6621867327600115</span>
<span class="o">*</span> <span class="mi">1</span><span class="o">-</span><span class="n">R</span><span class="o">/</span><span class="n">Z</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.0528273045414216</span>

<span class="o">...</span>
</pre></div>
</div>
<p>And so on until all waveforms have been downloaded and processed. You will
notice that a folder called <code class="docutils literal notranslate"><span class="pre">BNG_RESULTS/YH.LOBS3/</span></code> has been created.
This is where all processed files will be stored on disk.</p>
</div>
<div class="section" id="averaging">
<h3>2. Averaging<a class="headerlink" href="#averaging" title="Permalink to this headline">¶</a></h3>
<p>Now that all events have been processed, we wish to produce an average value
of station orientation. However, not all estimates have equal weight in the
final average. In particular, Braunmiller et al. (2020) have shown how a
combination of parameters can be used to exclude poorly constrained estimates
to produce a more robust final estimate. Here we will use all default values
in the script and specify arguments to plot and save final figures.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ bng_average --plot --save YH_list.pkl
</pre></div>
</div>
<p>An example log printed on the terminal will look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|==============================================|</span>
<span class="o">|</span>                      <span class="n">LOBS3</span>                   <span class="o">|</span>
<span class="o">|==============================================|</span>
<span class="o">|</span>  <span class="n">Station</span><span class="p">:</span> <span class="n">YH</span><span class="o">.</span><span class="n">LOBS3</span>                           <span class="o">|</span>
<span class="o">|</span>      <span class="n">Channel</span><span class="p">:</span> <span class="n">HH</span><span class="p">;</span> <span class="n">Locations</span><span class="p">:</span> <span class="o">--</span>              <span class="o">|</span>
<span class="o">|</span>      <span class="n">Lon</span><span class="p">:</span>  <span class="mf">179.15</span><span class="p">;</span> <span class="n">Lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">38.79</span>               <span class="o">|</span>
<span class="o">|</span> <span class="n">Input</span> <span class="n">Directory</span><span class="p">:</span>  <span class="n">BNG_RESULTS</span>
<span class="o">|</span> <span class="n">Plot</span> <span class="n">Results</span><span class="p">:</span>  <span class="kc">True</span>
<span class="o">|</span>
<span class="o">|</span>    <span class="n">B</span><span class="o">-</span><span class="n">N</span><span class="o">-</span><span class="n">G</span> <span class="n">mean</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">data</span> <span class="n">included</span><span class="p">:</span> <span class="mf">118.44</span><span class="p">,</span> <span class="mf">7.49</span><span class="p">,</span> <span class="mi">16</span>
</pre></div>
</div>
<p>The first figure to pop up will show the various combinations
of quality factors, highlighting the estimates that pass the
selected (default) thresholds</p>
<div class="figure align-center">
<img alt="_images/Figure_BNG_conditions.png" src="_images/Figure_BNG_conditions.png" />
</div>
<p>The second figure displays the estimates according to three parameters:</p>
<ul class="simple">
<li><p>Signal-to-noise ratio (SNR)</p></li>
<li><p>Cross-correlation coefficient (CC)</p></li>
<li><p>Earthquake magnitude</p></li>
</ul>
<div class="figure align-center">
<img alt="_images/Figure_BNG_results.png" src="_images/Figure_BNG_results.png" />
</div>
</div>
</div>
<div class="section" id="dl-analysis">
<h2>DL analysis<a class="headerlink" href="#dl-analysis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>1. Automated analysis<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>We wish to use the entire deployment time of station LOBS3 to calculate the
station orientation using Rayleigh-wave polarization data. Following the previous
example, since the file <code class="docutils literal notranslate"><span class="pre">YH_list.pkl</span></code> contains only one station, it is not
necessary to specify a key. Here we use all default parameters, except for the
minimum earthquake magnitude, which we set to 6.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ dl_calc --min-mag=6. YH_list.pkl
</pre></div>
</div>
<p>An example log printed on the terminal will look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">Establishing</span> <span class="n">Catalogue</span> <span class="n">Client</span><span class="o">...</span>
      <span class="n">Done</span>
   <span class="n">Establishing</span> <span class="n">Waveform</span> <span class="n">Client</span><span class="o">...</span>
      <span class="n">Done</span>

<span class="o">|==============================================|</span>
<span class="o">|</span>                      <span class="n">LOBS3</span>                   <span class="o">|</span>
<span class="o">|==============================================|</span>
<span class="o">|</span>  <span class="n">Station</span><span class="p">:</span> <span class="n">YH</span><span class="o">.</span><span class="n">LOBS3</span>                           <span class="o">|</span>
<span class="o">|</span>      <span class="n">Channel</span><span class="p">:</span> <span class="n">HH</span><span class="p">;</span> <span class="n">Locations</span><span class="p">:</span> <span class="o">--</span>              <span class="o">|</span>
<span class="o">|</span>      <span class="n">Lon</span><span class="p">:</span>  <span class="mf">179.15</span><span class="p">;</span> <span class="n">Lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">38.79</span>               <span class="o">|</span>
<span class="o">|</span>      <span class="n">Start</span> <span class="n">time</span><span class="p">:</span> <span class="mi">2014</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>         <span class="o">|</span>
<span class="o">|</span>      <span class="n">End</span> <span class="n">time</span><span class="p">:</span>   <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">23</span> <span class="mi">23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mi">59</span>         <span class="o">|</span>
<span class="o">|</span> <span class="n">Output</span> <span class="n">Directory</span><span class="p">:</span>  <span class="n">DL_RESULTS</span>
<span class="o">|</span> <span class="n">Save</span> <span class="n">Progress</span><span class="p">:</span>  <span class="kc">True</span>
<span class="o">|----------------------------------------------|</span>
<span class="o">|</span> <span class="n">Searching</span> <span class="n">Possible</span> <span class="n">events</span><span class="p">:</span>                   <span class="o">|</span>
<span class="o">|</span>   <span class="n">Start</span><span class="p">:</span> <span class="mi">2014</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>                 <span class="o">|</span>
<span class="o">|</span>   <span class="n">End</span><span class="p">:</span>   <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">23</span> <span class="mi">23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mi">59</span>                 <span class="o">|</span>
<span class="o">|</span>   <span class="n">Mag</span><span class="p">:</span>   <span class="o">&gt;</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="mf">3.1</span><span class="n">f</span><span class="p">}</span> <span class="mf">6.0</span>                       <span class="o">|</span>
<span class="o">|</span>   <span class="n">Min</span> <span class="n">Distance</span><span class="p">:</span>  <span class="mf">5.0</span>
<span class="o">|</span>   <span class="n">Max</span> <span class="n">Distance</span><span class="p">:</span>  <span class="mf">175.0</span>
<span class="o">|</span>   <span class="n">Max</span> <span class="n">Depth</span><span class="p">:</span>     <span class="mf">150.0</span>
<span class="o">|</span>   <span class="n">Request</span> <span class="n">Event</span> <span class="n">Catalogue</span><span class="o">...</span>                 <span class="o">|</span>
<span class="o">|</span> <span class="o">...</span>                                          <span class="o">|</span>
<span class="o">|</span>   <span class="n">Retrieved</span> <span class="mi">178</span> <span class="n">events</span>


<span class="o">**************************************************</span>
<span class="o">*</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">178</span><span class="p">):</span>  <span class="mi">20150620_021007</span> <span class="n">YH</span><span class="o">.</span><span class="n">LOBS3</span>
<span class="o">*</span>   <span class="n">Origin</span> <span class="n">Time</span><span class="p">:</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span> <span class="mi">02</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">07</span>
<span class="o">*</span>   <span class="n">Lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">36.33</span><span class="p">;</span>        <span class="n">Lon</span><span class="p">:</span>  <span class="o">-</span><span class="mf">73.67</span>
<span class="o">*</span>   <span class="n">Dep</span><span class="p">:</span>  <span class="mf">17.40</span> <span class="n">km</span><span class="p">;</span>     <span class="n">Mag</span><span class="p">:</span> <span class="mf">6.4</span>
<span class="o">*</span>   <span class="n">Dist</span><span class="p">:</span> <span class="mf">8837.94</span> <span class="n">km</span><span class="p">;</span>   <span class="n">Epi</span> <span class="n">dist</span><span class="p">:</span>  <span class="mf">79.48</span> <span class="n">deg</span>
<span class="o">*</span>   <span class="n">Baz</span><span class="p">:</span>  <span class="mf">128.47</span> <span class="n">deg</span><span class="p">;</span>   <span class="n">Az</span><span class="p">:</span> <span class="mf">229.25</span> <span class="n">deg</span>
<span class="o">*</span> <span class="n">Requesting</span> <span class="n">Waveforms</span><span class="p">:</span>
<span class="o">*</span>    <span class="n">Startime</span><span class="p">:</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span> <span class="mi">02</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">07</span>
<span class="o">*</span>    <span class="n">Endtime</span><span class="p">:</span>  <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span> <span class="mi">06</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">07</span>
<span class="o">*</span>     <span class="n">LOBS3</span><span class="o">.</span><span class="n">HH</span> <span class="o">-</span> <span class="n">ZNE</span><span class="p">:</span>
<span class="o">*</span>          <span class="n">HH</span><span class="p">[</span><span class="n">ZNE</span><span class="p">]</span><span class="o">.--</span> <span class="o">-</span> <span class="n">Checking</span> <span class="n">Network</span>
<span class="o">*</span>          <span class="n">HH</span><span class="p">[</span><span class="n">Z12</span><span class="p">]</span><span class="o">.--</span> <span class="o">-</span> <span class="n">Checking</span> <span class="n">Network</span>
<span class="o">*</span>              <span class="o">-</span> <span class="n">Z12</span> <span class="n">Data</span> <span class="n">Downloaded</span>
<span class="o">*</span> <span class="n">Start</span> <span class="n">times</span> <span class="n">are</span> <span class="ow">not</span> <span class="nb">all</span> <span class="n">close</span> <span class="n">to</span> <span class="n">true</span> <span class="n">start</span><span class="p">:</span>
<span class="o">*</span>   <span class="n">HH1</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span><span class="n">T02</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mf">07.650900</span><span class="n">Z</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span><span class="n">T06</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mf">07.638703</span><span class="n">Z</span>
<span class="o">*</span>   <span class="n">HH2</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span><span class="n">T02</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mf">07.651100</span><span class="n">Z</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span><span class="n">T06</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mf">07.638903</span><span class="n">Z</span>
<span class="o">*</span>   <span class="n">HHZ</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span><span class="n">T02</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mf">07.659300</span><span class="n">Z</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span><span class="n">T06</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mf">07.637103</span><span class="n">Z</span>
<span class="o">*</span>   <span class="kc">True</span> <span class="n">start</span><span class="p">:</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">20</span><span class="n">T02</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mf">07.650000</span><span class="n">Z</span>
<span class="o">*</span> <span class="o">-&gt;</span> <span class="n">Shifting</span> <span class="n">traces</span> <span class="n">to</span> <span class="n">true</span> <span class="n">start</span>
<span class="o">*</span> <span class="n">Sampling</span> <span class="n">rate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">an</span> <span class="n">integer</span> <span class="n">value</span><span class="p">:</span>  <span class="mf">100.00001525878906</span>
<span class="o">*</span> <span class="o">-&gt;</span> <span class="n">Resampling</span>
<span class="o">*</span> <span class="n">Waveforms</span> <span class="n">Retrieved</span><span class="o">...</span>
<span class="o">*</span> <span class="n">R1PHI</span><span class="p">:</span> <span class="p">[</span> <span class="mf">108.2734219</span>  <span class="mf">117.2734219</span>  <span class="mf">125.0734219</span>  <span class="mf">126.8734219</span>  <span class="mf">112.5734219</span>
  <span class="mf">101.3734219</span>  <span class="mf">121.3734219</span><span class="p">]</span>
<span class="o">*</span> <span class="n">R2PHI</span><span class="p">:</span> <span class="p">[</span> <span class="mf">120.3734219</span>  <span class="mf">114.6734219</span>  <span class="mf">114.8734219</span>    <span class="mf">9.3734219</span>    <span class="mf">4.4734219</span>
  <span class="mf">319.2734219</span>   <span class="mf">88.3734219</span><span class="p">]</span>
<span class="o">*</span> <span class="n">R1CC</span><span class="p">:</span> <span class="p">[</span> <span class="mf">0.3929253</span>   <span class="mf">0.63498115</span>  <span class="mf">0.79618113</span>  <span class="mf">0.76866093</span>  <span class="mf">0.52087365</span>  <span class="mf">0.28555018</span>
  <span class="mf">0.27791771</span><span class="p">]</span>
<span class="o">*</span> <span class="n">R2CC</span><span class="p">:</span> <span class="p">[</span> <span class="mf">0.27178087</span>  <span class="mf">0.07950989</span>  <span class="mf">0.16644224</span>  <span class="mf">0.51027084</span>  <span class="mf">0.24789322</span>  <span class="mf">0.04376891</span>
  <span class="mf">0.03245475</span><span class="p">]</span>

<span class="o">...</span>
</pre></div>
</div>
<p>And so on until all waveforms have been downloaded and processed. You will
notice that a folder called <code class="docutils literal notranslate"><span class="pre">DL_RESULTS/YH.LOBS3/</span></code> has been created.
This is where all processed files will be stored on disk.</p>
</div>
<div class="section" id="id2">
<h3>2. Averaging<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Now that all events have been processed, we wish to produce an average value
of station orientation. However, not all estimates have equal weight in the
final average. In particular, Doran and Laske have shown how to specify a
threshold cross-correlation (CC) value to exclude waveforms for which the CC
between the radial and Hilbert-transformed vertical component is low. Here we use
the default CC threshold of 0.8 and produce a final plot with the estimate.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ dl_average --plot YH_list.pkl
</pre></div>
</div>
<p>An example log printed on the terminal will look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|==============================================|</span>
<span class="o">|</span>                      <span class="n">LOBS3</span>                   <span class="o">|</span>
<span class="o">|==============================================|</span>
<span class="o">|</span>  <span class="n">Station</span><span class="p">:</span> <span class="n">YH</span><span class="o">.</span><span class="n">LOBS3</span>                           <span class="o">|</span>
<span class="o">|</span>      <span class="n">Channel</span><span class="p">:</span> <span class="n">HH</span><span class="p">;</span> <span class="n">Locations</span><span class="p">:</span> <span class="o">--</span>              <span class="o">|</span>
<span class="o">|</span>      <span class="n">Lon</span><span class="p">:</span>  <span class="mf">179.15</span><span class="p">;</span> <span class="n">Lat</span><span class="p">:</span> <span class="o">-</span><span class="mf">38.79</span>               <span class="o">|</span>
<span class="o">|</span> <span class="n">Input</span> <span class="n">Directory</span><span class="p">:</span>  <span class="n">DL_RESULTS</span>
<span class="o">|</span> <span class="n">Plot</span> <span class="n">Results</span><span class="p">:</span>  <span class="kc">True</span>
<span class="o">|</span>
<span class="o">|</span>    <span class="n">D</span><span class="o">-</span><span class="n">L</span> <span class="n">mean</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">data</span> <span class="n">included</span><span class="p">:</span> <span class="mf">122.95</span><span class="p">,</span> <span class="mf">3.99</span><span class="p">,</span> <span class="mi">284</span>
<span class="o">|</span>    <span class="n">D</span><span class="o">-</span><span class="n">L</span> <span class="n">CC</span> <span class="n">level</span><span class="p">:</span> <span class="mf">0.8</span>
</pre></div>
</div>
<p>The figure displays the estimates according to the CC value:</p>
<div class="figure align-center">
<img alt="_images/Figure_DL_results.png" src="_images/Figure_DL_results.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="scripts.html" class="btn btn-neutral float-left" title="Scripts" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Pascal Audet.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>